<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Super Admin Dashboard - QueueFlow</title>
 <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
 <link rel="stylesheet" href="{{ url_for('static', filename='css/theme.css') }}">
 
 
 
 
 </head>
<body class="page-content">
 <!-- Premium Internal Navbar -->
 {% set user_name = session.superadmin_username %}
 {% set user_type = 'superadmin' %}
 {% set breadcrumb = ['Super Admin', 'Registrations'] %}
 {% include 'includes/internal_navbar.html' %}

 <div class="container-fluid px-4 py-4">
 {% with messages = get_flashed_messages(with_categories=true) %}
 {% if messages %}
 {% for category, message in messages %}
 <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
 {{ message }}
 <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
 </div>
 {% endfor %}
 {% endif %}
 {% endwith %}

 <!-- Stats Cards -->
 <div class="row g-3 mb-4">
 <div class="col-6 col-md-3">
 <div class="card text-center">
 <div class="card-body py-3">
 <h2 class="display-4 fw-bold mb-1">{{ stats.pending }}</h2>
 <p class="mb-0 fw-semibold small">Pending</p>
 </div>
 </div>
 </div>
 <div class="col-6 col-md-3">
 <div class="card text-center">
 <div class="card-body py-3">
 <h2 class="display-4 fw-bold mb-1" style="color: var(--color-primary);">{{ stats.approved }}</h2>
 <p class="mb-0 fw-semibold small">Approved</p>
 </div>
 </div>
 </div>
 <div class="col-6 col-md-3">
 <div class="card text-center">
 <div class="card-body py-3">
 <h2 class="display-4 fw-bold mb-1">{{ stats.rejected }}</h2>
 <p class="mb-0 fw-semibold small">Rejected</p>
 </div>
 </div>
 </div>
 <div class="col-6 col-md-3">
 <div class="card text-center">
 <div class="card-body py-3">
 <h2 class="display-4 fw-bold mb-1" style="color: var(--color-primary);">{{ stats.total }}</h2>
 <p class="mb-0 fw-semibold small">Total</p>
 </div>
 </div>
 </div>
 </div>

 <!-- Pending Registrations -->
 <div class="card mb-4">
 <div class="card-header">
 <h5 class="mb-0 fw-semibold">â³ Pending Registrations ({{ pending|length }})</h5>
 </div>
 <div class="card-body p-0">
 {% if pending %}
 <div class="table-responsive">
 <table role="table" class="table table-hover mb-0">
 <thead role="rowgroup" class="table-light">
 <tr role="row">
 <th scope="col">Service Center</th>
 <th scope="col">Type</th>
 <th scope="col">Owner</th>
 <th scope="col">Contact</th>
 <th scope="col">Location</th>
 <th scope="col">Payment</th>
 <th scope="col">Submitted</th>
 <th scope="col">Actions</th>
 </tr>
 </thead>
 <tbody role="rowgroup">
 {% for reg in pending %}
 <tr role="row">
 <td role="cell" class="fw-bold" style="color: var(--color-primary);">{{ reg.center_name }}</td>
 <td role="cell"><span class="badge">{{ reg.organization_type }}</span></td>
 <td role="cell">{{ reg.owner_name }}</td>
 <td role="cell">
 <small>{{ reg.email }}</small><br>
 <small>{{ reg.phone }}</small>
 </td>
 <td role="cell">{{ reg.city }}, {{ reg.state }}</td>
 <td role="cell">
 {% if reg.payment_status == 'Completed' %}
 <span class="badge badge-success">âœ“ â‚¹{{ reg.registration_fee }}</span>
 {% else %}
 <span class="badge badge-warning">Pending</span>
 {% endif %}
 </td>
 <td role="cell"><small>{{ reg.submitted_time.strftime('%d %b %Y, %I:%M %p') }}</small></td>
 <td role="cell">
 <button class="btn btn-sm btn-success w-100" data-bs-toggle="modal" data-bs-target="#viewModal{{ reg.id }}">View</button>
 </td>
 </tr>
 
 <!-- View Modal -->
 <div class="modal fade" id="viewModal{{ reg.id }}" tabindex="-1">
 <div class="modal-dialog modal-fullscreen-sm-down modal-dialog-scrollable">
 <div class="modal-content">
 <div class="modal-header">
 <h5 class="modal-title fw-bold">{{ reg.center_name }}</h5>
 <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
 </div>
 <div class="modal-body">
 <!-- Payment Info Alert -->
 <div class="alert alert-{{ 'success' if reg.payment_status == 'Completed' else 'warning' }} mb-3">
 <div class="d-flex justify-content-between align-items-center flex-wrap gap-2">
 <div>
 <strong>ğŸ’³ Payment:</strong> 
 <span class="badge bg-{{ 'success' if reg.payment_status == 'Completed' else 'warning' }} ms-2">
 {{ reg.payment_status }}
 </span>
 </div>
 <div>
 <strong>â‚¹{{ reg.registration_fee }}</strong>
 {% if reg.payment_id %}
 <br><small>ID: {{ reg.payment_id }}</small>
 {% endif %}
 </div>
 </div>
 </div>

 <h6 class="fw-bold mb-2" style="color: var(--color-primary);">ğŸ›ï¸ Business Information</h6>
 <div class="row g-2 mb-3">
 <div class="col-6">
 <small class="text-muted">Organization Type</small><br>
 <strong>{{ reg.organization_type }}</strong>
 </div>
 <div class="col-6">
 <small class="text-muted">Years in Business</small><br>
 <strong>{{ reg.years_in_business or 'N/A' }}</strong>
 </div>
 {% if reg.gst_number %}
 <div class="col-12">
 <small class="text-muted">GST Number</small><br>
 <strong>{{ reg.gst_number }}</strong>
 </div>
 {% endif %}
 {% if reg.website %}
 <div class="col-12">
 <small class="text-muted">Website</small><br>
 <a href="{{ reg.website }}" target="_blank">{{ reg.website }}</a>
 </div>
 {% endif %}
 {% if reg.business_hours %}
 <div class="col-12">
 <small class="text-muted">Business Hours</small><br>
 <strong>{{ reg.business_hours }}</strong>
 </div>
 {% endif %}
 </div>

 <h6 class="fw-bold mb-2" style="color: var(--color-primary);">ğŸ‘¤ Owner Information</h6>
 <div class="row g-2 mb-3">
 <div class="col-6">
 <small class="text-muted">Owner/Manager</small><br>
 <strong>{{ reg.owner_name }}</strong>
 </div>
 <div class="col-6">
 <small class="text-muted">Email</small><br>
 <strong style="font-size: 0.85rem;">{{ reg.email }}</strong>
 </div>
 <div class="col-6">
 <small class="text-muted">Phone</small><br>
 <strong>{{ reg.phone }}</strong>
 </div>
 {% if reg.alternate_phone %}
 <div class="col-6">
 <small class="text-muted">Alternate Phone</small><br>
 <strong>{{ reg.alternate_phone }}</strong>
 </div>
 {% endif %}
 </div>

 <h6 class="fw-bold mb-2" style="color: var(--color-primary);">ğŸ“ Location</h6>
 <div class="row g-2 mb-3">
 <div class="col-12">
 <small class="text-muted">Address</small><br>
 <strong>{{ reg.address }}</strong>
 </div>
 <div class="col-4">
 <small class="text-muted">City</small><br>
 <strong>{{ reg.city }}</strong>
 </div>
 <div class="col-4">
 <small class="text-muted">State</small><br>
 <strong>{{ reg.state }}</strong>
 </div>
 <div class="col-4">
 <small class="text-muted">Pincode</small><br>
 <strong>{{ reg.pincode }}</strong>
 </div>
 </div>

 <h6 class="fw-bold mb-2" style="color: var(--color-primary);">ğŸ“Š Operational Details</h6>
 <div class="row g-2 mb-3">
 <div class="col-6">
 <small class="text-muted">Counters</small><br>
 <strong>{{ reg.counters or 'N/A' }}</strong>
 </div>
 <div class="col-6">
 <small class="text-muted">Daily Customers</small><br>
 <strong>{{ reg.daily_customers or 'N/A' }}</strong>
 </div>
 <div class="col-12">
 <small class="text-muted">Submitted On</small><br>
 <strong>{{ reg.submitted_time.strftime('%d %b %Y, %I:%M %p') }}</strong>
 </div>
 </div>

 {% if reg.additional_info %}
 <h6 class="fw-bold mb-2" style="color: var(--color-primary);">ğŸ“ Additional Info</h6>
 <div class="alert alert-light mb-0">
 {{ reg.additional_info }}
 </div>
 {% endif %}
 </div>
 <div class="modal-footer">
 <form method="POST" action="{{ url_for('reject_registration', reg_id=reg.id) }}" class="d-inline">
 <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Reject this registration?')">Reject</button>
 </form>
 <form method="POST" action="{{ url_for('approve_registration', reg_id=reg.id) }}" class="d-inline">
 <button type="submit" class="btn btn-success btn-sm" onclick="return confirm('Approve this registration?')">Approve</button>
 </form>
 </div>
 </div>
 </div>
 </div>
 {% endfor %}
 </tbody>
 </table>
 </div>
 {% else %}
 <div class="text-center py-5 text-muted">
 <p class="mb-0">No pending registrations</p>
 </div>
 {% endif %}
 </div>
 </div>

 <!-- Approved Registrations -->
 <div class="card mb-4">
 <div class="card-header">
 <h5 class="mb-0 fw-semibold">âœ… Recently Approved (Last 10)</h5>
 </div>
 <div class="card-body p-0">
 {% if approved %}
 <div class="table-responsive">
 <table role="table" class="table table-hover mb-0">
 <thead role="rowgroup" class="table-light">
 <tr role="row">
 <th scope="col">Service Center</th>
 <th scope="col">Type</th>
 <th scope="col">Owner</th>
 <th scope="col">Contact</th>
 <th scope="col">Approved On</th>
 </tr>
 </thead>
 <tbody role="rowgroup">
 {% for reg in approved %}
 <tr role="row">
 <td role="cell" class="fw-bold" style="color: var(--color-primary);">{{ reg.center_name }}</td>
 <td role="cell"><span class="badge">{{ reg.organization_type }}</span></td>
 <td role="cell">{{ reg.owner_name }}</td>
 <td role="cell"><small>{{ reg.email }}</small></td>
 <td role="cell"><small>{{ reg.reviewed_time.strftime('%d %b %Y') if reg.reviewed_time else '-' }}</small></td>
 </tr>
 {% endfor %}
 </tbody>
 </table>
 </div>
 {% else %}
 <div class="text-center py-4 text-muted">
 <p class="mb-0">No approved registrations yet</p>
 </div>
 {% endif %}
 </div>
 </div>

 <!-- Rejected Registrations -->
 <div class="card hover-lift fade-in-up">
 <div class="card-header">
 <h5 class="mb-0 fw-semibold">âŒ Recently Rejected (Last 10)</h5>
 </div>
 <div class="card-body p-0">
 {% if rejected %}
 <div class="table-responsive">
 <table role="table" class="table table-hover mb-0">
 <thead role="rowgroup" class="table-light">
 <tr role="row">
 <th scope="col">Service Center</th>
 <th scope="col">Type</th>
 <th scope="col">Owner</th>
 <th scope="col">Contact</th>
 <th scope="col">Rejected On</th>
 </tr>
 </thead>
 <tbody role="rowgroup">
 {% for reg in rejected %}
 <tr role="row">
 <td role="cell" class="fw-bold" style="color: var(--color-primary);">{{ reg.center_name }}</td>
 <td role="cell"><span class="badge">{{ reg.organization_type }}</span></td>
 <td role="cell">{{ reg.owner_name }}</td>
 <td role="cell"><small>{{ reg.email }}</small></td>
 <td role="cell"><small>{{ reg.reviewed_time.strftime('%d %b %Y') if reg.reviewed_time else '-' }}</small></td>
 </tr>
 {% endfor %}
 </tbody>
 </table>
 </div>
 {% else %}
 <div class="text-center py-4 text-muted">
 <p class="mb-0">No rejected registrations</p>
 </div>
 {% endif %}
 </div>
 </div>
 </div>

 <script src="{{ url_for('static', filename='js/bootstrap.bundle.min.js') }}"></script>
</body>
</html>
