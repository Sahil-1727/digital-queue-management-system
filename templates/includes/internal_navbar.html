<!-- Premium Internal Dashboard Navbar -->
<nav class="internal-navbar">
    <div class="internal-nav-container">
        <a href="{% if user_type == 'admin' %}{{ url_for('admin_dashboard') }}{% elif user_type == 'superadmin' %}{{ url_for('superadmin_dashboard') }}{% else %}{{ url_for('services') }}{% endif %}" class="internal-brand">
            <span class="brand-icon">Q</span>
            <span class="brand-name">QueueFlow</span>
        </a>
        
        {% if breadcrumb %}
        <div class="nav-breadcrumb">
            {% for item in breadcrumb %}
                <span class="breadcrumb-item">{{ item }}</span>
                {% if not loop.last %}<span class="breadcrumb-sep">/</span>{% endif %}
            {% endfor %}
        </div>
        {% endif %}
        
        <div class="nav-right">
            <div class="user-menu">
                <button class="user-menu-trigger" id="userMenuTrigger">
                    <div class="user-avatar">{{ user_name[0] if user_name else 'U' }}</div>
                    <span class="user-name">{{ user_name }}</span>
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="chevron">
                        <path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                
                <div class="user-dropdown" id="userDropdown">
                    {% if user_type == 'admin' %}
                        <a href="{{ url_for('admin_profile') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="5" r="3" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M3 14C3 11.2386 5.23858 9 8 9C10.7614 9 13 11.2386 13 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Profile
                        </a>
                        <a href="{{ url_for('admin_analytics') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="10" width="3" height="4" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="6.5" y="6" width="3" height="8" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="11" y="2" width="3" height="12" rx="1" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            Analytics
                        </a>
                        <a href="{{ url_for('admin_history') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M8 4V8L11 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            History
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('admin_logout') }}" class="dropdown-item text-danger">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M6 14H3C2.44772 14 2 13.5523 2 13V3C2 2.44772 2.44772 2 3 2H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M11 11L14 8L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 8H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Logout
                        </a>
                    {% elif user_type == 'superadmin' %}
                        <a href="{{ url_for('superadmin_dashboard') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="2" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="9" y="2" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="2" y="9" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="9" y="9" width="5" height="5" rx="1" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            Dashboard
                        </a>
                        <a href="{{ url_for('superadmin_analytics') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="10" width="3" height="4" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="6.5" y="6" width="3" height="8" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <rect x="11" y="2" width="3" height="12" rx="1" stroke="currentColor" stroke-width="1.5"/>
                            </svg>
                            Analytics
                        </a>
                        <a href="{{ url_for('superadmin_admins') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="6" cy="5" r="2" stroke="currentColor" stroke-width="1.5"/>
                                <circle cx="11" cy="5" r="2" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M2 13C2 11.3431 3.34315 10 5 10H7C8.65685 10 10 11.3431 10 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M10 13C10 11.8954 10.8954 11 12 11H13C14.1046 11 15 11.8954 15 13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Admins
                        </a>
                        <a href="{{ url_for('superadmin_manage_centers') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="3" width="12" height="10" rx="1" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M5 6H11M5 9H9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Centers
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('superadmin_logout') }}" class="dropdown-item text-danger">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M6 14H3C2.44772 14 2 13.5523 2 13V3C2 2.44772 2.44772 2 3 2H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M11 11L14 8L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 8H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Logout
                        </a>
                    {% else %}
                        <a href="{{ url_for('user_profile') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="5" r="3" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M3 14C3 11.2386 5.23858 9 8 9C10.7614 9 13 11.2386 13 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Profile
                        </a>
                        <a href="{{ url_for('user_history') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M8 4V8L11 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            History
                        </a>
                        <a href="{{ url_for('track_token') }}" class="dropdown-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M8 5V8L10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Track Token
                        </a>
                        <div class="dropdown-divider"></div>
                        <a href="{{ url_for('logout') }}" class="dropdown-item text-danger">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M6 14H3C2.44772 14 2 13.5523 2 13V3C2 2.44772 2.44772 2 3 2H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M11 11L14 8L11 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M14 8H6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Logout
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const trigger = document.getElementById('userMenuTrigger');
    const dropdown = document.getElementById('userDropdown');
    
    if (trigger && dropdown) {
        trigger.addEventListener('click', function(e) {
            e.stopPropagation();
            dropdown.classList.toggle('active');
            trigger.classList.toggle('active');
        });
        
        document.addEventListener('click', function() {
            dropdown.classList.remove('active');
            trigger.classList.remove('active');
        });
        
        dropdown.addEventListener('click', function(e) {
            e.stopPropagation();
        });
    }
});
</script>
